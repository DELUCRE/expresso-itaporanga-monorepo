{
  "$schema": "https://railway.app/railway.schema.json",
  "services": [
    {
      "name": "backend",
      "build": {
        "builder": "NIXPACKS",
        "nixpacksConfig": {
          "providers": ["python"],
          "phases": {
            "setup": {
              "nixPkgs": ["python311", "poetry"]
            },
            "install": {
              "cmd": "pip install -r requirements.txt"
            }
          }
        }
      },
      "startCommand": "gunicorn --bind 0.0.0.0:$PORT src.app:app",
      "healthcheckPath": "/",
      "rootDirectory": "./backend"
    },
    {
      "name": "frontend",
      "build": {
        "builder": "NIXPACKS",
        "nixpacksConfig": {
          "providers": ["node"],
          "phases": {
            "setup": {
              "nixPkgs": ["nodejs_18", "npm"]
            },
            "install": {
              "cmd": "npm install"
            }
          }
        }
      },
      "startCommand": "npm start",
      "healthcheckPath": "/",
      "rootDirectory": "./frontend"
    }
  ]
}
